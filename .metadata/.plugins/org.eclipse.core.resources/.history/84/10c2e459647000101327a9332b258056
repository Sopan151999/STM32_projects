/*
 * Hdl_CAN.c
 *
 *  Created on: Aug 3, 2025
 *      Author: sopan
 */


#include <GBL_declare.h>
#include <Hdl_CAN.h>

volatile uint8_t recivedbyte;

void HAL_CAN_RxFifo1MsgPendingCallback(CAN_HandleTypeDef *hcan){
	HAL_CAN_GetRxMessage(hcan,CAN_RX_FIFO1, &RxHeader, RxData);
	if(RxHeader.StdId==0x500){
		recivedbyte=RxData[0];
	}

	if(RxHeader.StdId==0x500){
		HAL_CAN_AddTxMessage(hcan,&RxHeader, RxData, &TxMailBox);
		}
	if(RxHeader.StdId==0x102){
			HAL_CAN_AddTxMessage(hcan,&RxHeader, RxData, &TxMailBox);
			}
}


HAL_CAN_Start(&hcan);

HAL_CAN_ActivateNotification(&hcan, CAN_IT_RX_FIFO1_MSG_PENDING);

TxHeader.IDE = CAN_ID_STD;
TxHeader.StdId = 0x103;
TxHeader.RTR = CAN_RTR_DATA;
TxHeader.DLC = 8;

TxData[0] = 50;
TxData[1] = 0xAA;
TxData[2] = 50;
TxData[3] = 0xAA;
TxData[4] = 50;
TxData[5] = 0xAA;
TxData[6] = 50;
TxData[7] = 0xAA;
HAL_CAN_AddTxMessage(&hcan,&TxHeader, TxData, &TxMailBox);
